---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
```

```{r}
airlines_raw <- read_csv("data/airlines.csv")
airports_raw <- read_csv("data/airports.csv")
flights_raw <- read_csv("data/flights.csv")
planes_raw <- read_csv("data/planes.csv")
weather_raw <- read_csv("data/weather.csv")
```

```{r}
weather_raw %>%
  filter(origin == "EWR") %>% 
  summarise(across(.cols = everything(),
                   .fns = ~sum(!is.na(.x))/8735*100))
```

```{r}
flights_raw %>% 
  filter(origin == "EWR") %>% 
  dim()
```

```{r}
flights_raw %>% 
  filter(origin == "EWR") %>%
  group_by(year, month, day) %>% 
  count()
```

```{r}
airports_raw %>% 
  summarise(across(.cols = everything(),
                   .fns = ~sum(is.na(.x))))
```

```{r}
flights_raw %>% 
  summarise(across(.cols = everything(),
                   .fns = ~sum(is.na(.x))))
```

```{r}
planes_raw %>% 
  summarise(across(.cols = everything(),
                   .fns = ~sum(is.na(.x))))
```

--------------------------------------------------------------------------------

# CLEANING

```{r}
airlines <- airlines_raw %>% 
  rename("airline_name" = "name")
```

```{r}
flights <- flights_raw %>%
  select(month, day, hour, dep_delay, carrier, flight, 
         tailnum, origin, distance, time_hour) %>% 
  drop_na() %>% 
  mutate(delayed = if_else(dep_delay > 0, "Yes", "No"))
```

```{r}
flights_EWR <- flights %>% 
  filter(origin == "EWR") %>% 
  select(-origin)
```

```{r}
planes <- planes_raw %>% 
  select(-speed)
```

```{r}
weather <- weather_raw %>% 
  select(-year, -month, -day, -hour)
```

```{r}
weather_EWR <- weather %>% 
  filter(origin == "EWR") %>% 
  select(-origin)
```
